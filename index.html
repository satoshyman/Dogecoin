
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>DOGE Cloud Mining Pro - Single File Edition</title>
    
    <!-- Scripts & Dependencies -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://adsgram.ai/sdk.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --tg-theme-bg-color: #020617;
            --tg-theme-text-color: #f8fafc;
        }
        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            user-select: none;
            overflow: hidden;
            margin: 0;
            padding: 0;
            touch-action: manipulation;
        }
        #root {
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
        }
        .loading-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: radial-gradient(circle at center, #0f172a 0%, #020617 100%);
            color: #eab308;
            gap: 24px;
        }
        .loader {
            width: 60px;
            height: 60px;
            border: 4px solid #1e293b;
            border-top-color: #eab308;
            border-radius: 50%;
            animation: spin 1s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .animate-fadeIn { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        ::-webkit-scrollbar { width: 0px; background: transparent; }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/",
    "vite": "https://esm.sh/vite@^7.3.1",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.2"
  }
}
</script>
</head>
<body>
    <div id="root">
        <div class="loading-screen">
            <div class="loader"></div>
            <div class="text-xl font-black">DOGE MINER PRO</div>
        </div>
    </div>

    <!-- React Project Code -->
    <script type="text/babel" data-presets="react,typescript">
        const { useState, useEffect, useCallback, useMemo, useRef } = React;

        // --- CONSTANTS ---
        const DEFAULT_SETTINGS = {
            miningRatePerSession: 5.0,
            sessionDurationMs: 4 * 60 * 60 * 1000,
            referralCommission: 10,
            minWithdrawal: 100.0,
            dailyGiftAmount: 1.0,
            adsgramBlockId: '3946',
            adminBotToken: '',
            adminChatId: '',
            adminPassword: '123',
            tasks: [
                { id: 't1', title: 'Follow Doge on X', reward: 2.0, type: 'social' },
                { id: 't2', title: 'Watch Reward Video', reward: 1.5, type: 'ad' }
            ]
        };

        const Page = {
            Mining: 'mining',
            Tasks: 'tasks',
            Referrals: 'referrals',
            Wallet: 'wallet',
            Admin: 'admin'
        };

        // --- COMPONENTS ---

        const MiningPage = ({ state, settings, onStart, onEnd, onClaimGift }) => {
            const [timeLeft, setTimeLeft] = useState(0);
            const [curEarnings, setCurEarnings] = useState(0);
            const [giftTime, setGiftTime] = useState(0);

            useEffect(() => {
                let interval;
                if (state.isMining && state.miningStartTime) {
                    interval = setInterval(() => {
                        const elapsed = Date.now() - state.miningStartTime;
                        const rem = settings.sessionDurationMs - elapsed;
                        if (rem <= 0) {
                            onEnd();
                            setTimeLeft(0);
                            setCurEarnings(0);
                        } else {
                            setTimeLeft(rem);
                            setCurEarnings((elapsed / settings.sessionDurationMs) * settings.miningRatePerSession);
                        }
                    }, 100);
                }
                return () => clearInterval(interval);
            }, [state.isMining, state.miningStartTime, settings, onEnd]);

            useEffect(() => {
                const itv = setInterval(() => {
                    const rem = 86400000 - (Date.now() - (state.lastGiftClaimedTime || 0));
                    setGiftTime(rem > 0 ? rem : 0);
                }, 1000);
                return () => clearInterval(itv);
            }, [state.lastGiftClaimedTime]);

            const formatTime = (ms) => {
                const h = Math.floor(ms / 3600000);
                const m = Math.floor((ms % 3600000) / 60000);
                const s = Math.floor((ms % 60000) / 1000);
                return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            };

            const progress = state.isMining ? ((settings.sessionDurationMs - timeLeft) / settings.sessionDurationMs) * 100 : 0;

            return (
                <div className="flex flex-col items-center gap-8 py-4 animate-fadeIn">
                    <div className="w-full bg-slate-900/40 backdrop-blur-xl border border-white/5 p-4 rounded-[2rem] flex justify-between items-center shadow-lg">
                        <div className="flex items-center gap-4">
                            <div className="w-12 h-12 bg-yellow-500/10 rounded-2xl flex items-center justify-center text-2xl">ğŸ</div>
                            <div>
                                <p className="text-[10px] font-black text-slate-500 uppercase">Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</p>
                                <p className="text-sm font-black text-white">{settings.dailyGiftAmount.toFixed(2)} <span className="text-yellow-500">DOGE</span></p>
                            </div>
                        </div>
                        <button 
                            onClick={onClaimGift}
                            disabled={giftTime > 0}
                            className={`px-8 py-3 rounded-2xl text-xs font-black transition-all ${giftTime > 0 ? 'bg-slate-800 text-slate-500' : 'bg-yellow-600 text-white active:scale-95 animate-bounce'}`}
                        >
                            {giftTime > 0 ? formatTime(giftTime) : 'Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø¢Ù†'}
                        </button>
                    </div>

                    <div className="relative w-72 h-72 flex items-center justify-center">
                        <svg className="absolute inset-0 transform -rotate-90 w-full h-full">
                            <circle cx="50%" cy="50%" r="42%" fill="transparent" stroke="#1e293b" strokeWidth="8" />
                            <circle cx="50%" cy="50%" r="42%" fill="transparent" stroke="#eab308" strokeWidth="10" strokeDasharray="100 100" strokeDashoffset={100 - progress} pathLength="100" strokeLinecap="round" className="transition-all duration-300 ease-linear" />
                        </svg>
                        <div className={`relative w-48 h-48 rounded-full bg-slate-950 border-[6px] flex flex-col items-center justify-center transition-all ${state.isMining ? 'border-yellow-500 shadow-[0_0_30px_rgba(234,179,8,0.2)]' : 'border-slate-800 opacity-60'}`}>
                            <img src="https://cryptologos.cc/logos/dogecoin-doge-logo.svg?v=040" className={`w-24 h-24 mb-2 ${state.isMining ? 'animate-spin' : ''}`} style={{ animationDuration: '5s' }} />
                            <p className="text-[10px] font-black text-slate-500">{state.isMining ? 'Mining Active' : 'Idle'}</p>
                        </div>
                    </div>

                    <div className="w-full grid grid-cols-2 gap-4">
                        <div className="bg-slate-900/60 p-6 rounded-[2.5rem] border border-white/5 text-center">
                            <span className="text-[10px] text-slate-500 font-black uppercase">Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø¬Ù„Ø³Ø©</span>
                            <p className="text-2xl font-black text-white">{curEarnings.toFixed(4)}</p>
                        </div>
                        <div className="bg-slate-900/60 p-6 rounded-[2.5rem] border border-white/5 text-center">
                            <span className="text-[10px] text-slate-500 font-black uppercase">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</span>
                            <p className="text-2xl font-black text-white">{formatTime(state.isMining ? timeLeft : settings.sessionDurationMs)}</p>
                        </div>
                    </div>

                    <button 
                        onClick={onStart} 
                        disabled={state.isMining}
                        className={`w-full py-6 rounded-[2.5rem] text-xl font-black transition-all ${state.isMining ? 'bg-slate-800 text-slate-500' : 'bg-yellow-600 text-white active:scale-95 shadow-lg shadow-yellow-600/20'}`}
                    >
                        {state.isMining ? 'ØªØ¹Ø¯ÙŠÙ† Ù†Ø´Ø·...' : 'Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¹Ø¯ÙŠÙ†'}
                    </button>
                </div>
            );
        };

        const TasksPage = ({ state, settings, onComplete }) => {
            const [loadingTask, setLoadingTask] = useState(null);
            const simulateTask = async (id, reward, type) => {
                setLoadingTask(id);
                await new Promise(r => setTimeout(r, 2000));
                onComplete(id, reward);
                setLoadingTask(null);
            };
            return (
                <div className="flex flex-col gap-4 py-4 animate-fadeIn">
                    <h2 className="text-2xl font-black text-yellow-500 text-center mb-4">Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h2>
                    {settings.tasks.map(task => {
                        const isCompleted = state.completedTasks.includes(task.id);
                        return (
                            <div key={task.id} className="bg-slate-900 p-4 rounded-2xl flex justify-between items-center border border-white/5">
                                <div>
                                    <h4 className="font-bold">{task.title}</h4>
                                    <p className="text-xs text-green-400">+{task.reward} DOGE</p>
                                </div>
                                <button disabled={isCompleted || loadingTask} onClick={() => simulateTask(task.id, task.reward, task.type)} className={`px-6 py-2 rounded-xl text-sm font-black ${isCompleted ? 'bg-slate-800 text-slate-600' : 'bg-yellow-600'}`}>
                                    {isCompleted ? 'Ù…ÙƒØªÙ…Ù„' : loadingTask === task.id ? '...' : 'Ø§Ø¨Ø¯Ø£'}
                                </button>
                            </div>
                        );
                    })}
                </div>
            );
        };

        const WalletPage = ({ state, settings, onUpdateAddress, onWithdraw }) => {
            const [val, setVal] = useState('');
            const [addr, setAddr] = useState(state.withdrawalAddress);
            return (
                <div className="flex flex-col gap-6 py-4 animate-fadeIn">
                    <div className="bg-yellow-600 p-8 rounded-[2.5rem] shadow-xl">
                        <p className="text-xs font-black opacity-70">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„ÙƒÙ„ÙŠ</p>
                        <h2 className="text-5xl font-black">{state.balance.toFixed(2)} <span className="text-sm opacity-50">DOGE</span></h2>
                    </div>
                    <div className="bg-slate-900 p-6 rounded-[2.5rem] space-y-4">
                        <input type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©" value={addr} onChange={e => {setAddr(e.target.value); onUpdateAddress(e.target.value);}} className="w-full bg-slate-950 border border-slate-800 rounded-2xl py-4 px-5 text-sm outline-none" />
                        <input type="number" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº" value={val} onChange={e => setVal(e.target.value)} className="w-full bg-slate-950 border border-slate-800 rounded-2xl py-4 px-5 text-sm outline-none" />
                        <button onClick={() => onWithdraw(parseFloat(val), addr)} className="w-full py-4 bg-yellow-600 rounded-2xl font-black">Ø·Ù„Ø¨ Ø³Ø­Ø¨</button>
                    </div>
                </div>
            );
        };

        const ReferralPage = ({ state, settings }) => {
            const link = `https://t.me/your_bot?start=${state.userId}`;
            return (
                <div className="flex flex-col gap-6 py-4 animate-fadeIn">
                    <div className="bg-slate-900 p-8 rounded-[2.5rem] border border-yellow-500/20 text-center">
                        <p className="text-slate-500 text-xs font-black mb-2">Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</p>
                        <h2 className="text-5xl font-black text-yellow-500">{settings.referralCommission}%</h2>
                    </div>
                    <div className="bg-slate-900 p-6 rounded-[2.5rem] space-y-4">
                        <p className="text-xs text-slate-500 font-bold">Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ:</p>
                        <div className="bg-black p-4 rounded-xl text-[10px] font-mono text-yellow-500 break-all">{link}</div>
                        <button onClick={() => window.open(`https://t.me/share/url?url=${link}`)} className="w-full py-4 bg-yellow-600 rounded-2xl font-black">Ø¯Ø¹ÙˆØ© Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡</button>
                    </div>
                </div>
            );
        };

        const AdminDashboard = ({ settings, onSaveSettings, withdrawals, onUpdateWithdrawal, onClose }) => {
            const [local, setLocal] = useState(settings);
            return (
                <div className="fixed inset-0 bg-slate-950 z-[200] flex flex-col p-6 overflow-y-auto">
                    <div className="flex justify-between items-center mb-8">
                        <h2 className="text-2xl font-black">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
                        <button onClick={onClose} className="bg-slate-800 p-2 rounded-xl">âœ–</button>
                    </div>
                    <div className="space-y-4">
                        <div className="bg-slate-900 p-4 rounded-2xl">
                            <label className="text-xs text-slate-500">Ø±Ø¨Ø­ Ø§Ù„Ø¬Ù„Ø³Ø©</label>
                            <input type="number" value={local.miningRatePerSession} onChange={e => setLocal({...local, miningRatePerSession: parseFloat(e.target.value)})} className="w-full bg-transparent text-yellow-500 font-black outline-none" />
                        </div>
                        <div className="bg-slate-900 p-4 rounded-2xl">
                            <label className="text-xs text-slate-500">ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</label>
                            <input type="text" value={local.adminPassword} onChange={e => setLocal({...local, adminPassword: e.target.value})} className="w-full bg-transparent text-yellow-500 font-black outline-none" />
                        </div>
                        <button onClick={() => {onSaveSettings(local); alert('ØªÙ… Ø§Ù„Ø­ÙØ¸');}} className="w-full py-4 bg-yellow-600 rounded-2xl font-black">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                    </div>
                </div>
            );
        };

        // --- MAIN APP COMPONENT ---
        const App = () => {
            const [currentPage, setCurrentPage] = useState(Page.Mining);
            const [showAdmin, setShowAdmin] = useState(false);
            const [adminClicks, setAdminClicks] = useState(0);

            const [settings, setSettings] = useState(() => {
                const s = localStorage.getItem('doge_s');
                return s ? JSON.parse(s) : DEFAULT_SETTINGS;
            });

            const [user, setUser] = useState(() => {
                const u = localStorage.getItem('doge_u');
                return u ? JSON.parse(u) : {
                    balance: 0, miningStartTime: null, isMining: false, completedTasks: [],
                    withdrawalAddress: '', referralsCount: 0, referralEarnings: 0,
                    userId: Math.random().toString(36).substring(7).toUpperCase(),
                    withdrawalHistory: [], lastGiftClaimedTime: null
                };
            });

            useEffect(() => {
                localStorage.setItem('doge_s', JSON.stringify(settings));
                localStorage.setItem('doge_u', JSON.stringify(user));
            }, [settings, user]);

            const haptic = (s = 'light') => window.Telegram?.WebApp?.HapticFeedback?.impactOccurred(s);

            const handleLogoClick = () => {
                haptic();
                if (adminClicks + 1 >= 8) { setShowAdmin(true); setAdminClicks(0); }
                else setAdminClicks(adminClicks + 1);
            };

            return (
                <div className="flex flex-col min-h-screen">
                    <header className="p-4 bg-slate-900 flex justify-between items-center sticky top-0 z-50">
                        <div className="flex items-center gap-2" onClick={handleLogoClick}>
                            <img src="https://cryptologos.cc/logos/dogecoin-doge-logo.svg?v=040" className="w-8 h-8" />
                            <span className="font-black text-yellow-500">DOGE PRO</span>
                        </div>
                        <div className="bg-slate-800 px-4 py-1 rounded-full text-yellow-500 text-xs font-black border border-yellow-500/20">
                            {user.balance.toFixed(4)} <span className="opacity-50">DOGE</span>
                        </div>
                    </header>

                    <main className="flex-1 px-6 pb-32">
                        {currentPage === Page.Mining && <MiningPage state={user} settings={settings} onStart={() => {haptic('medium'); setUser({...user, isMining: true, miningStartTime: Date.now()});}} onEnd={() => {haptic('success'); setUser({...user, isMining: false, balance: user.balance + settings.miningRatePerSession, miningStartTime: null});}} onClaimGift={() => {haptic('success'); setUser({...user, balance: user.balance + settings.dailyGiftAmount, lastGiftClaimedTime: Date.now()});}} />}
                        {currentPage === Page.Tasks && <TasksPage state={user} settings={settings} onComplete={(id, r) => {haptic('success'); setUser({...user, balance: user.balance + r, completedTasks: [...user.completedTasks, id]});}} />}
                        {currentPage === Page.Wallet && <WalletPage state={user} settings={settings} onUpdateAddress={a => setUser({...user, withdrawalAddress: a})} onWithdraw={(am, ad) => {haptic('heavy'); setUser({...user, balance: user.balance - am, withdrawalHistory: [{id: 'W'+Date.now(), amount: am, address: ad, status: 'Processing'}, ...user.withdrawalHistory]}); alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨');}} />}
                        {currentPage === Page.Referrals && <ReferralPage state={user} settings={settings} />}
                    </main>

                    {showAdmin && <AdminDashboard settings={settings} onSaveSettings={setSettings} withdrawals={user.withdrawalHistory} onUpdateWithdrawal={()=>{}} onClose={()=>setShowAdmin(false)} />}

                    <nav className="fixed bottom-6 left-6 right-6 bg-slate-900 border border-white/5 flex justify-around p-3 rounded-[2rem] shadow-2xl z-[100]">
                        <button onClick={() => {haptic(); setCurrentPage(Page.Mining);}} className={`flex flex-col items-center gap-1 ${currentPage === Page.Mining ? 'text-yellow-500' : 'text-slate-600'}`}>
                            <span className="text-xl">â›ï¸</span><span className="text-[8px] font-black">ØªØ¹Ø¯ÙŠÙ†</span>
                        </button>
                        <button onClick={() => {haptic(); setCurrentPage(Page.Tasks);}} className={`flex flex-col items-center gap-1 ${currentPage === Page.Tasks ? 'text-yellow-500' : 'text-slate-600'}`}>
                            <span className="text-xl">ğŸ“‹</span><span className="text-[8px] font-black">Ù…Ù‡Ø§Ù…</span>
                        </button>
                        <button onClick={() => {haptic(); setCurrentPage(Page.Referrals);}} className={`flex flex-col items-center gap-1 ${currentPage === Page.Referrals ? 'text-yellow-500' : 'text-slate-600'}`}>
                            <span className="text-xl">ğŸ‘¥</span><span className="text-[8px] font-black">Ø¥Ø­Ø§Ù„Ø§Øª</span>
                        </button>
                        <button onClick={() => {haptic(); setCurrentPage(Page.Wallet);}} className={`flex flex-col items-center gap-1 ${currentPage === Page.Wallet ? 'text-yellow-500' : 'text-slate-600'}`}>
                            <span className="text-xl">ğŸ’°</span><span className="text-[8px] font-black">Ù…Ø­ÙØ¸Ø©</span>
                        </button>
                    </nav>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
